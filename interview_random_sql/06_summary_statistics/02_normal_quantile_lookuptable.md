# Generate the Quantile Lookuptable of a Normal Standard Distribution

We want to generate the `z` score values of the Quantile Normal Distribution. We'll be using the [q_norm](./q_norm.sql) function.

## Problem

The quantile table for values of `q` in the range `(0 1)`.

```console
q   |    _00    |    _01    |    _02    |    _03    |    _04    |    _05    |    _06    |    _07    |    _08    |    _09
----+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------
0.0 |           | -2.326348 | -2.053749 | -1.880794 | -1.750686 | -1.644853 | -1.554773 | -1.475791 | -1.405072 | -1.340755
0.1 | -1.281552 | -1.226528 | -1.174987 | -1.126391 | -1.080319 | -1.036433 | -0.994458 | -0.954165 | -0.915365 | -0.877896
0.2 | -0.841621 | -0.806421 | -0.772193 | -0.738847 | -0.706303 | -0.674490 | -0.643345 | -0.612813 | -0.582842 | -0.553385
0.3 | -0.524401 | -0.495850 | -0.467699 | -0.439913 | -0.412463 | -0.385320 | -0.358459 | -0.331853 | -0.305481 | -0.279319
0.4 | -0.253347 | -0.227545 | -0.201893 | -0.176374 | -0.150969 | -0.125661 | -0.100434 | -0.075270 | -0.050154 | -0.025069
0.5 |  0.000000 |  0.025069 |  0.050154 |  0.075270 |  0.100434 |  0.125661 |  0.150969 |  0.176374 |  0.201893 |  0.227545
0.6 |  0.253347 |  0.279319 |  0.305481 |  0.331853 |  0.358459 |  0.385320 |  0.412463 |  0.439913 |  0.467699 |  0.495850
0.7 |  0.524401 |  0.553385 |  0.582842 |  0.612813 |  0.643345 |  0.674490 |  0.706303 |  0.738847 |  0.772193 |  0.806421
0.8 |  0.841621 |  0.877896 |  0.915365 |  0.954165 |  0.994458 |  1.036433 |  1.080319 |  1.126391 |  1.174987 |  1.226528
0.9 |  1.281552 |  1.340755 |  1.405072 |  1.475791 |  1.554773 |  1.644853 |  1.750686 |  1.880794 |  2.053749 |  2.326348
(10 rows)
```


## Solution

```SQL
WITH RECURSIVE q_normalz
AS (
  SELECT 0.0 AS q
       , qnorm(0.00)::NUMERIC(7,6) AS _00
       , qnorm(0.01)::NUMERIC(7,6) AS _01
       , qnorm(0.02)::NUMERIC(7,6) AS _02
       , qnorm(0.03)::NUMERIC(7,6) AS _03
       , qnorm(0.04)::NUMERIC(7,6) AS _04
       , qnorm(0.05)::NUMERIC(7,6) AS _05
       , qnorm(0.06)::NUMERIC(7,6) AS _06
       , qnorm(0.07)::NUMERIC(7,6) AS _07
       , qnorm(0.08)::NUMERIC(7,6) AS _08
       , qnorm(0.09)::NUMERIC(7,6) AS _09
  UNION ALL
  SELECT q + 0.1 AS q
       , qnorm(q + 0.1 + 0.00)::NUMERIC(7,6) AS _00
       , qnorm(q + 0.1 + 0.01)::NUMERIC(7,6) AS _01
       , qnorm(q + 0.1 + 0.02)::NUMERIC(7,6) AS _02
       , qnorm(q + 0.1 + 0.03)::NUMERIC(7,6) AS _03
       , qnorm(q + 0.1 + 0.04)::NUMERIC(7,6) AS _04
       , qnorm(q + 0.1 + 0.05)::NUMERIC(7,6) AS _05
       , qnorm(q + 0.1 + 0.06)::NUMERIC(7,6) AS _06
       , qnorm(q + 0.1 + 0.07)::NUMERIC(7,6) AS _07
       , qnorm(q + 0.1 + 0.08)::NUMERIC(7,6) AS _08
       , qnorm(q + 0.1 + 0.09)::NUMERIC(7,6) AS _09
   FROM q_normalz
  WHERE q < 0.9
)
SELECT  q
      , CASE WHEN q = 0.0 THEN NULL ELSE _00 END AS _00
      , _01, _02, _03, _04, _05, _06, _07, _08, _09
  FROM q_normalz;
```


```SQL
WITH RECURSIVE q_normalz
AS (
  SELECT 0.5 AS q
       , qnorm(0.5)::NUMERIC(7,6) AS z
  UNION ALL
  SELECT q + 0.01 AS q
       , qnorm(q + 0.01)::NUMERIC(7,6) AS z
   FROM q_normalz
  WHERE q < 0.99
)
SELECT  q
      , z
      , ROUND((z::NUMERIC)*100,0)
      , LPAD('*',ROUND((z::NUMERIC)*100,0)::INTEGER,'*') AS z_plot
  FROM q_normalz
 ORDER BY q;
```

```console
q    |    z     | round |                                                                                                                  z_plot
-----+----------+-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
0.5 | 0.000000 |     0 |
0.51 | 0.025069 |     3 | ***
0.52 | 0.050154 |     5 | *****
0.53 | 0.075270 |     8 | ********
0.54 | 0.100434 |    10 | **********
0.55 | 0.125661 |    13 | *************
0.56 | 0.150969 |    15 | ***************
0.57 | 0.176374 |    18 | ******************
0.58 | 0.201893 |    20 | ********************
0.59 | 0.227545 |    23 | ***********************
0.60 | 0.253347 |    25 | *************************
0.61 | 0.279319 |    28 | ****************************
0.62 | 0.305481 |    31 | *******************************
0.63 | 0.331853 |    33 | *********************************
0.64 | 0.358459 |    36 | ************************************
0.65 | 0.385320 |    39 | ***************************************
0.66 | 0.412463 |    41 | *****************************************
0.67 | 0.439913 |    44 | ********************************************
0.68 | 0.467699 |    47 | ***********************************************
0.69 | 0.495850 |    50 | **************************************************
0.70 | 0.524401 |    52 | ****************************************************
0.71 | 0.553385 |    55 | *******************************************************
0.72 | 0.582842 |    58 | **********************************************************
0.73 | 0.612813 |    61 | *************************************************************
0.74 | 0.643345 |    64 | ****************************************************************
0.75 | 0.674490 |    67 | *******************************************************************
0.76 | 0.706303 |    71 | ***********************************************************************
0.77 | 0.738847 |    74 | **************************************************************************
0.78 | 0.772193 |    77 | *****************************************************************************
0.79 | 0.806421 |    81 | *********************************************************************************
0.80 | 0.841621 |    84 | ************************************************************************************
0.81 | 0.877896 |    88 | ****************************************************************************************
0.82 | 0.915365 |    92 | ********************************************************************************************
0.83 | 0.954165 |    95 | ***********************************************************************************************
0.84 | 0.994458 |    99 | ***************************************************************************************************
0.85 | 1.036433 |   104 | ********************************************************************************************************
0.86 | 1.080319 |   108 | ************************************************************************************************************
0.87 | 1.126391 |   113 | *****************************************************************************************************************
0.88 | 1.174987 |   117 | *********************************************************************************************************************
0.89 | 1.226528 |   123 | ***************************************************************************************************************************
0.90 | 1.281552 |   128 | ********************************************************************************************************************************
0.91 | 1.340755 |   134 | **************************************************************************************************************************************
0.92 | 1.405072 |   141 | *********************************************************************************************************************************************
0.93 | 1.475791 |   148 | ****************************************************************************************************************************************************
0.94 | 1.554773 |   155 | ***********************************************************************************************************************************************************
0.95 | 1.644853 |   164 | ********************************************************************************************************************************************************************
0.96 | 1.750686 |   175 | *******************************************************************************************************************************************************************************
0.97 | 1.880794 |   188 | ********************************************************************************************************************************************************************************************
0.98 | 2.053749 |   205 | *************************************************************************************************************************************************************************************************************
0.99 | 2.326348 |   233 | *****************************************************************************************************************************************************************************************************************************************
(50 rows)
```
